<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="tgis.map.service.MapActionMapper">

<!-- 현재위치가져오기 -->
<select id="getCenterAddr" parameterType="map" resultType="String">
	<![CDATA[
		SELECT
			TEMP.*
		FROM
			(
			SELECT
				'청주시'	||' '|| CONCAT(CONCAT(B.SIG_KOR_NM, ' '), A.EMD_KOR_NM) AS GU_NAM
			FROM
				GT_LP_AA_EMD A,
				GT_LP_AA_SGG B

			WHERE
				MDSYS.SDO_RELATE(
					a.XGEO,
					MDSYS.SDO_GEOMETRY(2001,5181,SDO_POINT_TYPE(#{x},
				#{y},NULL),NULL,NULL
					),
				'MASK=ANYINTERACT') = 'TRUE'
				AND
					MDSYS.SDO_RELATE(
					B.XGEO,
					MDSYS.SDO_GEOMETRY(2001,5181,SDO_POINT_TYPE(#{x},
				#{y},NULL),NULL,NULL
					),
				'MASK=ANYINTERACT') = 'TRUE') TEMP
		WHERE ROWNUM = 1

	]]>
	</select>

	<select id="roadPop" parameterType="map" resultType="egovMap">
		<![CDATA[
			SELECT road_bt,RN
			FROM TL_SPRD_MANAGE
			WHERE sdo_nn(xgeo, MDSYS.SDO_GEOMETRY(2001,5181,SDO_POINT_TYPE(#{x},#{y},NULL),NULL,NULL),'sdo_num_res=1 distance=20 unit=m', 1) = 'TRUE'
		]]>

	</select>

	<select id="selectGu" parameterType="map" resultType="egovMap">
	SELECT SIG_KOR_NM, sig_cd
	FROM GT_LP_AA_SGG
	WHERE SIG_CD = #{sggCde}

	</select>

</mapper>